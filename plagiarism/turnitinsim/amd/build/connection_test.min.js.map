{"version":3,"sources":["../src/connection_test.js"],"names":["define","$","str","connectionTest","ct","length","click","ajax","type","url","M","cfg","wwwroot","dataType","data","action","sesskey","apiurl","val","apikey","success","removeClass","connection_status","addClass","get_string","done","text","changeString","delay","fadeOut","fadeIn","langString","get","tagName","attr"],"mappings":"AA4BAA,OAAM,0CAAC,CAAC,QAAD,CAAW,UAAX,CAAD,CAAyB,SAASC,CAAT,CAAYC,CAAZ,CAAiB,CAC5C,MAAO,CACHC,cAAc,CAAE,yBAAW,CAEvB,GAAIC,CAAAA,CAAE,CAAGH,CAAC,CAAC,qBAAD,CAAV,CAEA,GAAgB,CAAZ,CAAAG,CAAE,CAACC,MAAP,CAAmB,CACfD,CAAE,CAACE,KAAH,CAAS,UAAW,CAChBL,CAAC,CAACM,IAAF,CAAO,CACHC,IAAI,CAAE,MADH,CAEHC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,kDAFlB,CAGHC,QAAQ,CAAE,MAHP,CAIHC,IAAI,CAAE,CACFC,MAAM,CAAE,iBADN,CAEFC,OAAO,CAAEN,CAAC,CAACC,GAAF,CAAMK,OAFb,CAGFC,MAAM,CAAEhB,CAAC,CAAC,oBAAD,CAAD,CAAwBiB,GAAxB,EAHN,CAIFC,MAAM,CAAElB,CAAC,CAAC,oBAAD,CAAD,CAAwBiB,GAAxB,EAJN,CAJH,CAUHE,OAAO,CAAE,iBAASN,CAAT,CAAe,CACpBV,CAAE,CAACiB,WAAH,CAAe,eAAf,EACA,GAA+B,GAA3B,GAAAP,CAAI,CAACQ,iBAAT,CAAoC,CAChClB,CAAE,CAACiB,WAAH,CAAe,YAAf,EACAjB,CAAE,CAACmB,QAAH,CAAY,aAAZ,EAEArB,CAAG,CAACsB,UAAJ,CAAe,oBAAf,CAAqC,wBAArC,EAA+DC,IAA/D,CAAoE,SAASC,CAAT,CAAe,CAC/EC,CAAY,CAACvB,CAAD,CAAKsB,CAAL,CACf,CAFD,CAGH,CAPD,IAOO,CACHtB,CAAE,CAACiB,WAAH,CAAe,aAAf,EACAjB,CAAE,CAACmB,QAAH,CAAY,YAAZ,EAEArB,CAAG,CAACsB,UAAJ,CAAe,mBAAf,CAAoC,wBAApC,EAA8DC,IAA9D,CAAmE,SAASC,CAAT,CAAe,CAC9EC,CAAY,CAACvB,CAAD,CAAKsB,CAAL,CACf,CAFD,CAGH,CAGDtB,CAAE,CAACwB,KAAH,CAAS,GAAT,EAAeC,OAAf,CAAuB,MAAvB,CAA+B,UAAW,CACtCzB,CAAE,CAACiB,WAAH,CAAe,YAAf,EACAjB,CAAE,CAACiB,WAAH,CAAe,aAAf,EACApB,CAAC,CAAC,IAAD,CAAD,CAAQsB,QAAR,CAAiB,eAAjB,EAEArB,CAAG,CAACsB,UAAJ,CAAe,aAAf,CAA8B,wBAA9B,EAAwDC,IAAxD,CAA6D,SAASC,CAAT,CAAe,CACxEC,CAAY,CAACvB,CAAD,CAAKsB,CAAL,CACf,CAFD,CAGH,CARD,EAQGI,MARH,CAQU,MARV,CASH,CAtCE,CAAP,CAwCH,CAzCD,CA0CH,CAOD,QAASH,CAAAA,CAAT,CAAsBvB,CAAtB,CAA0B2B,CAA1B,CAAsC,CAClC,GAA0B,QAAtB,GAAA3B,CAAE,CAAC4B,GAAH,CAAO,CAAP,EAAUC,OAAd,CAAoC,CAChC7B,CAAE,CAACsB,IAAH,CAAQK,CAAR,CACH,CAFD,IAEO,CACH3B,CAAE,CAAC8B,IAAH,CAAQ,OAAR,CAAiBH,CAAjB,CACH,CACJ,CACJ,CA9DE,CAgEV,CAjEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for the Turnitin Connection Test.\n *\n * @package   plagiarism_turnitinsim\n * @copyright 2018 Turnitin\n * @author    David Winn <dwinn@turnitin.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module plagiarism_turnitinsim/connection_test\n */\n\ndefine(['jquery', 'core/str'], function($, str) {\n    return {\n        connectionTest: function() {\n            // Store connection test selector.\n            var ct = $('#id_connection_test');\n\n            if (ct.length > 0) {\n                ct.click(function() {\n                    $.ajax({\n                        type: \"POST\",\n                        url: M.cfg.wwwroot + \"/plagiarism/turnitinsim/ajax/connection_test.php\",\n                        dataType: \"json\",\n                        data: {\n                            action: \"connection_test\",\n                            sesskey: M.cfg.sesskey,\n                            apiurl: $('#id_turnitinapiurl').val(),\n                            apikey: $('#id_turnitinapikey').val()\n                        },\n                        success: function(data) {\n                            ct.removeClass(\"btn-secondary\");\n                            if (data.connection_status === 200) {\n                                ct.removeClass(\"btn-danger\");\n                                ct.addClass(\"btn-success\");\n\n                                str.get_string('connecttestsuccess', 'plagiarism_turnitinsim').done(function(text) {\n                                    changeString(ct, text);\n                                });\n                            } else {\n                                ct.removeClass(\"btn-success\");\n                                ct.addClass(\"btn-danger\");\n\n                                str.get_string('connecttestfailed', 'plagiarism_turnitinsim').done(function(text) {\n                                    changeString(ct, text);\n                                });\n                            }\n\n                            // Fade out classes and swap back values.\n                            ct.delay(3000).fadeOut(\"slow\", function() {\n                                ct.removeClass(\"btn-danger\");\n                                ct.removeClass(\"btn-success\");\n                                $(this).addClass(\"btn-secondary\");\n\n                                str.get_string('connecttest', 'plagiarism_turnitinsim').done(function(text) {\n                                    changeString(ct, text);\n                                });\n                            }).fadeIn(\"slow\");\n                        }\n                    });\n                });\n            }\n\n            /**\n             * Helper function to change the button text depending on which type of element we're handling.\n             * @param {jQuery} ct - The button element - may be input or button depending on the Moodle theme.\n             * @param {String} langString  - The language string we're setting.\n             */\n            function changeString(ct, langString) {\n                if (ct.get(0).tagName === \"BUTTON\") {\n                    ct.text(langString);\n                } else {\n                    ct.attr('value', langString);\n                }\n            }\n        }\n    };\n});"],"file":"connection_test.min.js"}