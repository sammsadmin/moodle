{"version":3,"file":"sent_messages.min.js","names":["define","$","noti","jaxy","removeSentItems","data","qmAjax","JSON","stringify","call","params","ids","class","then","response","storeMsg","location","reload","catch","init","showMsg","on","ev","preventDefault","click","counter","length","show","hide","toggle","checked","prop","remove_list","each","push"],"sources":["../src/sent_messages.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package    block_quickmail\n * @copyright  2008 onwards Louisiana State University\n * @copyright  2008 onwards Chad Mazilly, Robert Russo, Jason Peak, Dave Elliott, Adam Zapletal, Philip Cali, David Lowe\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\n\ndefine([\n    'jquery',\n    'block_quickmail/notifications',\n    'block_quickmail/jaxy'\n], function($, noti, jaxy) {\n    'use strict';\n\n    let removeSentItems = function(data) {\n        jaxy.qmAjax(JSON.stringify({\n            'call': 'remove_sent_messages',\n            'params': {\n                'ids': data\n            },\n            // 'path': 'classes/external/',\n            'class': 'sent_messages_ctrl'\n        // eslint-disable-next-line promise/always-return\n        })).then(function (response) {\n            noti.storeMsg(response);\n            /* TODO: To reduce server calls via page reload this could remove table\n             rows but needs to factor the pagination results.\n             for (var i of response.data.ids) {\n                 // $(this).find(\"[data-msgid='\" + i + \"']\").closest(\"tr\").remove();\n                 $('.qm_sent_msgs').find(\"[data-msgid='\" + i + \"']\").closest(\"tr\").remove();\n             }\n             But instead, let's just reload the page\n            */\n            location.reload();\n        }).catch ();\n    };\n\n    return {\n        init: function() {\n            // Show any pending messages.\n            noti.showMsg();\n\n            // Single Click Delete (Trash Icon).\n            $('.qm_sent_msgs').on('click', '.qm_sm_trash', function (ev) {\n                ev.preventDefault();\n                removeSentItems([$(this).data(\"msgid\")]);\n            });\n\n            // Single Checkbox Click.\n            // If more than 1 checkbox is checked then show the \"remove selected\" button.\n            $('.qm_sm_cb').click(function() {\n                let counter = $(\":checkbox:checked\").length;\n                if (counter > 1) {\n                    $(\"#qm_sm_selected_remove\").show();\n                } else {\n                    $(\"#qm_sm_selected_remove\").hide();\n                }\n            });\n\n            // Select ALL Checkboxes.\n            $(\"#qm_sm_select_all\").click(function () {\n                $(\"#qm_sm_selected_remove\").toggle(this.checked);\n                $('input:checkbox').prop('checked', this.checked);\n            });\n\n            // Remove Selected Button Click.\n            $('.qm_sent_msgs').on('click', '#qm_sm_selected_remove', function (ev) {\n                ev.preventDefault();\n                let remove_list = [];\n                $(\".qm_sm_cb:checkbox:checked\").each(function() {\n                    remove_list.push($(this).data(\"msgid\"));\n                });\n                removeSentItems(remove_list);\n            });\n        }\n    };\n});\n"],"mappings":"AAwBAA,OAAM,iCAAC,CACH,QAAQ,CACR,+BAA+B,CAC/B,sBAAsB,CACzB,CAAE,SAASC,CAAC,CAAEC,CAAI,CAAEC,CAAI,CAAE,CACvB,YAAY,CAEZ,GAAI,CAAAC,CAAe,CAAG,QAAAA,CAASC,CAAI,CAAE,CACjCF,CAAI,CAACG,MAAM,CAACC,IAAI,CAACC,SAAS,CAAC,CACvBC,IAAA,CAAQ,sBAAsB,CAC9BC,MAAA,CAAU,CACNC,GAAA,CAAON,CACX,CAAC,CAEDO,KAAA,CAAS,oBAEb,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,SAAUC,CAAQ,CAAE,CACzBZ,CAAI,CAACa,QAAQ,CAACD,CAAQ,CAAC,CASvBE,QAAQ,CAACC,MAAM,EACnB,CAAC,CAAC,CAACC,KAAK,EACZ,CAAC,CAED,MAAO,CACHC,IAAI,CAAE,SAAAA,KAAA,CAAW,CAEbjB,CAAI,CAACkB,OAAO,EAAE,CAGdnB,CAAC,CAAC,eAAe,CAAC,CAACoB,EAAE,CAAC,OAAO,CAAE,cAAc,CAAE,SAAUC,CAAE,CAAE,CACzDA,CAAE,CAACC,cAAc,EAAE,CACnBnB,CAAe,CAAC,CAACH,CAAC,CAAC,IAAI,CAAC,CAACI,IAAI,CAAC,OAAO,CAAC,CAAC,CAC3C,CAAC,CAAC,CAIFJ,CAAC,CAAC,WAAW,CAAC,CAACuB,KAAK,CAAC,UAAW,CAC5B,GAAI,CAAAC,CAAO,CAAGxB,CAAC,CAAC,mBAAmB,CAAC,CAACyB,MAAM,CAC3C,GAAc,CAAC,CAAXD,CAAW,CAAE,CACbxB,CAAC,CAAC,wBAAwB,CAAC,CAAC0B,IAAI,EACpC,CAAC,IAAM,CACH1B,CAAC,CAAC,wBAAwB,CAAC,CAAC2B,IAAI,EACpC,CACJ,CAAC,CAAC,CAGF3B,CAAC,CAAC,mBAAmB,CAAC,CAACuB,KAAK,CAAC,UAAY,CACrCvB,CAAC,CAAC,wBAAwB,CAAC,CAAC4B,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,CAChD7B,CAAC,CAAC,gBAAgB,CAAC,CAAC8B,IAAI,CAAC,SAAS,CAAE,IAAI,CAACD,OAAO,CACpD,CAAC,CAAC,CAGF7B,CAAC,CAAC,eAAe,CAAC,CAACoB,EAAE,CAAC,OAAO,CAAE,wBAAwB,CAAE,SAAUC,CAAE,CAAE,CACnEA,CAAE,CAACC,cAAc,EAAE,CACnB,GAAI,CAAAS,CAAW,CAAG,EAAE,CACpB/B,CAAC,CAAC,4BAA4B,CAAC,CAACgC,IAAI,CAAC,UAAW,CAC5CD,CAAW,CAACE,IAAI,CAACjC,CAAC,CAAC,IAAI,CAAC,CAACI,IAAI,CAAC,OAAO,CAAC,CAC1C,CAAC,CAAC,CACFD,CAAe,CAAC4B,CAAW,CAC/B,CAAC,CACL,CACJ,CACJ,CAAC,CAAC"}